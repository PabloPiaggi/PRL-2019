# vim:ft=plumed

UNITS LENGTH=A

energy: ENERGY

# Construct a bias potential using VES
#
# Basis functions

bf1: BF_LEGENDRE ORDER=20 MINIMUM=-25000 MAXIMUM=-23500

# Target distributions

TD_MULTICANONICAL ...
 LABEL=td_multi
 SIGMA=50.0
 MIN_TEMP=400
 MAX_TEMP=600
 THRESHOLD=1
... TD_MULTICANONICAL


# Expansion

VES_LINEAR_EXPANSION ...
 ARG=energy
 BASIS_FUNCTIONS=bf1
 TEMP=500.0
 GRID_BINS=1000
 TARGET_DISTRIBUTION=td_multi
 LABEL=b1
... VES_LINEAR_EXPANSION

# Optimization algorithm

OPT_AVERAGED_SGD ...
  BIAS=b1
  STRIDE=500
  LABEL=o1
  STEPSIZE=1.
  FES_OUTPUT=500
  BIAS_OUTPUT=500
  TARGETDIST_OUTPUT=500
  COEFFS_OUTPUT=100
  TARGETDIST_STRIDE=500
... OPT_AVERAGED_SGD

PRINT ARG=* FILE=COLVAR STRIDE=500

